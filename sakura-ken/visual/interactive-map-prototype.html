<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ê°úÁúå„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Éû„ÉÉ„Éó - „Éó„É≠„Éà„Çø„Ç§„Éó</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f5f5f5;
        }
        
        #header {
            background-color: #FFB6C1;
            color: white;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        #header h1 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        
        #container {
            display: flex;
            height: calc(100vh - 120px);
        }
        
        #sidebar {
            width: 300px;
            background-color: white;
            padding: 1rem;
            overflow-y: auto;
            box-shadow: 2px 0 4px rgba(0,0,0,0.1);
        }
        
        #map {
            flex: 1;
            height: 100%;
        }
        
        #info-panel {
            width: 350px;
            background-color: white;
            padding: 1rem;
            overflow-y: auto;
            box-shadow: -2px 0 4px rgba(0,0,0,0.1);
            display: none;
        }
        
        #info-panel.active {
            display: block;
        }
        
        .layer-control {
            margin-bottom: 1.5rem;
        }
        
        .layer-control h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: #333;
        }
        
        .layer-checkbox {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .layer-checkbox input {
            margin-right: 0.5rem;
        }
        
        .city-info {
            background-color: #f9f9f9;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .city-info h2 {
            color: #C71585;
            margin-bottom: 0.5rem;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid #eee;
        }
        
        .info-label {
            font-weight: bold;
            color: #666;
        }
        
        .info-value {
            color: #333;
        }
        
        .chart-container {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #f5f5f5;
            border-radius: 8px;
        }
        
        #footer {
            background-color: #333;
            color: white;
            padding: 1rem;
            text-align: center;
            font-size: 0.875rem;
        }
        
        .leaflet-popup-content {
            font-size: 0.875rem;
        }
        
        .legend {
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .legend h4 {
            margin-bottom: 5px;
            font-size: 0.875rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 5px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <div id="header">
        <h1>üå∏ Ê°úÁúå„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Éû„ÉÉ„Éó</h1>
        <p>ÂêÑÂ∏Ç„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Ë©≥Á¥∞ÊÉÖÂ†±„ÇíË°®Á§∫</p>
    </div>
    
    <div id="container">
        <div id="sidebar">
            <div class="layer-control">
                <h3>Ë°®Á§∫„É¨„Ç§„É§„Éº</h3>
                <div class="layer-checkbox">
                    <input type="checkbox" id="cities-layer" checked>
                    <label for="cities-layer">Â∏ÇÂ¢ÉÁïå</label>
                </div>
                <div class="layer-checkbox">
                    <input type="checkbox" id="labels-layer" checked>
                    <label for="labels-layer">Âú∞Âêç„É©„Éô„É´</label>
                </div>
                <div class="layer-checkbox">
                    <input type="checkbox" id="population-layer">
                    <label for="population-layer">‰∫∫Âè£ÂØÜÂ∫¶</label>
                </div>
            </div>
            
            <div class="layer-control">
                <h3>„Éá„Éº„ÇøË°®Á§∫</h3>
                <select id="data-type" style="width: 100%; padding: 0.5rem;">
                    <option value="none">„Å™„Åó</option>
                    <option value="population">‰∫∫Âè£</option>
                    <option value="density">‰∫∫Âè£ÂØÜÂ∫¶</option>
                    <option value="area">Èù¢Á©ç</option>
                </select>
            </div>
            
            <div class="layer-control">
                <h3>Áµ±Ë®àÊÉÖÂ†±</h3>
                <div class="info-item">
                    <span class="info-label">Á∑è‰∫∫Âè£</span>
                    <span class="info-value">285‰∏á4,327‰∫∫</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Á∑èÈù¢Á©ç</span>
                    <span class="info-value">2,456.78 km¬≤</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Â∏Ç„ÅÆÊï∞</span>
                    <span class="info-value">6Â∏Ç</span>
                </div>
            </div>
        </div>
        
        <div id="map"></div>
        
        <div id="info-panel">
            <h2>Ë©≥Á¥∞ÊÉÖÂ†±</h2>
            <div id="city-details">
                <p>Â∏Ç„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Ë©≥Á¥∞„ÇíË°®Á§∫</p>
            </div>
        </div>
    </div>
    
    <div id="footer">
        <p>¬© 2025 Ê°úÁúå„Éó„É≠„Ç∏„Çß„ÇØ„Éà | „Éá„Éº„ÇøÊúÄÁµÇÊõ¥Êñ∞: 2025Âπ¥7Êúà11Êó•</p>
    </div>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // Âú∞Âõ≥„ÅÆÂàùÊúüÂåñ
        const map = L.map('map').setView([35.45, 139.55], 10);
        
        // „Éô„Éº„Çπ„Éû„ÉÉ„Éó
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors'
        }).addTo(map);
        
        // Â∏Ç„ÅÆ„Éá„Éº„ÇøÔºàÂÆüÈöõ„ÅÆJSON„Éï„Ç°„Ç§„É´„Åã„ÇâÁ∞°Áï•ÂåñÔºâ
        const cityData = {
            "Ê°úËä±Â∏Ç": {
                population: 890234,
                density: 1948.3,
                area: 456.78,
                type: "ÁúåÂ∫ÅÊâÄÂú®Âú∞",
                industries: ["ÈáëËûç„Éª‰øùÈô∫Ê•≠", "ÊÉÖÂ†±ÈÄö‰ø°Ê•≠", "ÂïÜÊ•≠„Éª„Çµ„Éº„Éì„ÇπÊ•≠"],
                mayor: "Áî∞‰∏≠‰∏ÄÈÉé"
            },
            "Ê°úÂ∑ùÂ∏Ç": {
                population: 523456,
                density: 1344.2,
                area: 389.45,
                type: "Ê∏ØÊπæÈÉΩÂ∏Ç",
                industries: ["Ê∏ØÊπæÁâ©ÊµÅÊ•≠", "Ê∞¥Áî£Ê•≠", "ÈÄ†ËàπÊ•≠"],
                mayor: "Êµ∑ÈáéÊ¥ãÂ≠ê"
            },
            "Êù±Ê°úÂ∏Ç": {
                population: 412345,
                density: 1319.2,
                area: 312.67,
                type: "„Éè„Ç§„ÉÜ„ÇØÂ∑•Ê•≠ÈÉΩÂ∏Ç",
                industries: ["ÈõªÂ≠êÊ©üÂô®Ë£ΩÈÄ†Ê•≠", "ÊÉÖÂ†±ÈÄö‰ø°Ê•≠", "Á†îÁ©∂ÈñãÁô∫"],
                mayor: "ÊäÄË°ìÂ§™ÈÉé"
            },
            "Ë•øÊ°úÂ∏Ç": {
                population: 198765,
                density: 847.8,
                area: 234.56,
                type: "Ê≠¥Âè≤ÊñáÂåñÈÉΩÂ∏Ç",
                industries: ["‰ºùÁµ±Â∑•Ëä∏", "Ë¶≥ÂÖâÊ•≠", "ÊñáÂåñÁî£Ê•≠"],
                mayor: "ÊñáÂåñËä±Â≠ê"
            },
            "ÂçóÊ°úÂ∏Ç": {
                population: 287654,
                density: 506.5,
                area: 567.89,
                type: "Ê∏©Ê≥âË¶≥ÂÖâÈÉΩÂ∏Ç",
                industries: ["Ë¶≥ÂÖâÊ•≠", "ÊóÖÈ§®„Éª„Éõ„ÉÜ„É´Ê•≠", "Ëæ≤Ê•≠"],
                mayor: "Ê∏©Ê≥âÊ¨°ÈÉé"
            },
            "ÂåóÊ°úÂ∏Ç": {
                population: 156789,
                density: 351.9,
                area: 445.67,
                type: "Ëæ≤Ê•≠ÈÉΩÂ∏Ç",
                industries: ["Ëæ≤Ê•≠", "È£üÂìÅÂä†Â∑•Ê•≠", "ÁïúÁî£Ê•≠"],
                mayor: "Ëæ≤Ê•≠‰∏âÈÉé"
            }
        };
        
        // Ëâ≤„ÅÆÂèñÂæóÈñ¢Êï∞
        function getColor(density) {
            return density > 1500 ? '#800026' :
                   density > 1000 ? '#BD0026' :
                   density > 800  ? '#E31A1C' :
                   density > 600  ? '#FC4E2A' :
                   density > 400  ? '#FD8D3C' :
                   density > 200  ? '#FEB24C' :
                                    '#FFEDA0';
        }
        
        // „Çπ„Çø„Ç§„É´Èñ¢Êï∞
        function style(feature) {
            const city = cityData[feature.properties.name];
            return {
                fillColor: getColor(city ? city.density : 0),
                weight: 2,
                opacity: 1,
                color: 'white',
                dashArray: '3',
                fillOpacity: 0.7
            };
        }
        
        // „Éè„Ç§„É©„Ç§„ÉàÊ©üËÉΩ
        function highlightFeature(e) {
            const layer = e.target;
            
            layer.setStyle({
                weight: 5,
                color: '#666',
                dashArray: '',
                fillOpacity: 0.7
            });
            
            layer.bringToFront();
        }
        
        // „É™„Çª„ÉÉ„ÉàÊ©üËÉΩ
        function resetHighlight(e) {
            geojsonLayer.resetStyle(e.target);
        }
        
        // „ÇØ„É™„ÉÉ„ÇØÊôÇ„ÅÆË©≥Á¥∞Ë°®Á§∫
        function showCityDetails(cityName) {
            const city = cityData[cityName];
            if (!city) return;
            
            const infoPanel = document.getElementById('info-panel');
            infoPanel.classList.add('active');
            
            const detailsHtml = `
                <div class="city-info">
                    <h2>${cityName}</h2>
                    <div class="info-item">
                        <span class="info-label">„Çø„Ç§„Éó</span>
                        <span class="info-value">${city.type}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">‰∫∫Âè£</span>
                        <span class="info-value">${city.population.toLocaleString()}‰∫∫</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Èù¢Á©ç</span>
                        <span class="info-value">${city.area} km¬≤</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">‰∫∫Âè£ÂØÜÂ∫¶</span>
                        <span class="info-value">${city.density}‰∫∫/km¬≤</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Â∏ÇÈï∑</span>
                        <span class="info-value">${city.mayor}</span>
                    </div>
                </div>
                <div class="chart-container">
                    <h3>‰∏ªË¶ÅÁî£Ê•≠</h3>
                    <ul>
                        ${city.industries.map(ind => `<li>${ind}</li>`).join('')}
                    </ul>
                </div>
            `;
            
            document.getElementById('city-details').innerHTML = detailsHtml;
        }
        
        // ÂêÑ„Éï„Ç£„Éº„ÉÅ„É£„Éº„Å´ÂØæ„Åô„ÇãÂá¶ÁêÜ
        function onEachFeature(feature, layer) {
            // „Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó
            if (feature.properties && feature.properties.name) {
                const city = cityData[feature.properties.name];
                if (city) {
                    layer.bindPopup(`
                        <strong>${feature.properties.name}</strong><br>
                        ‰∫∫Âè£: ${city.population.toLocaleString()}‰∫∫<br>
                        Èù¢Á©ç: ${city.area} km¬≤
                    `);
                }
            }
            
            // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
            layer.on({
                mouseover: highlightFeature,
                mouseout: resetHighlight,
                click: function(e) {
                    showCityDetails(feature.properties.name);
                }
            });
        }
        
        // „Çµ„É≥„Éó„É´GeoJSON„Éá„Éº„ÇøÔºàÁ∞°Áï•ÂåñÔºâ
        const sakuraGeoJSON = {
            "type": "FeatureCollection",
            "features": [
                {
                    "type": "Feature",
                    "properties": {
                        "name": "Ê°úËä±Â∏Ç"
                    },
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [[
                            [139.45, 35.48],
                            [139.58, 35.48],
                            [139.58, 35.38],
                            [139.45, 35.38],
                            [139.45, 35.48]
                        ]]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {
                        "name": "Ê°úÂ∑ùÂ∏Ç"
                    },
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [[
                            [139.62, 35.38],
                            [139.75, 35.38],
                            [139.75, 35.28],
                            [139.62, 35.28],
                            [139.62, 35.38]
                        ]]
                    }
                }
                // ‰ªñ„ÅÆÂ∏Ç„ÇÇÂêåÊßò„Å´ËøΩÂä†ÂèØËÉΩ
            ]
        };
        
        // GeoJSON„É¨„Ç§„É§„Éº„ÅÆËøΩÂä†
        const geojsonLayer = L.geoJSON(sakuraGeoJSON, {
            style: style,
            onEachFeature: onEachFeature
        }).addTo(map);
        
        // Âá°‰æã„ÅÆËøΩÂä†
        const legend = L.control({position: 'bottomright'});
        
        legend.onAdd = function (map) {
            const div = L.DomUtil.create('div', 'legend');
            const grades = [0, 200, 400, 600, 800, 1000, 1500];
            
            div.innerHTML = '<h4>‰∫∫Âè£ÂØÜÂ∫¶Ôºà‰∫∫/km¬≤Ôºâ</h4>';
            
            for (let i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<div class="legend-item">' +
                    '<div class="legend-color" style="background:' + getColor(grades[i] + 1) + '"></div>' +
                    grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] : '+') +
                    '</div>';
            }
            
            return div;
        };
        
        legend.addTo(map);
        
        // „É¨„Ç§„É§„Éº„Ç≥„É≥„Éà„É≠„Éº„É´
        document.getElementById('population-layer').addEventListener('change', function(e) {
            if (e.target.checked) {
                legend.addTo(map);
            } else {
                legend.remove();
            }
        });
    </script>
</body>
</html>