<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¡œçœŒã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒãƒƒãƒ— - ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f5f5f5;
        }
        
        #header {
            background-color: #FFB6C1;
            color: white;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        #header h1 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        
        #container {
            display: flex;
            height: calc(100vh - 120px);
        }
        
        #sidebar {
            width: 300px;
            background-color: white;
            padding: 1rem;
            overflow-y: auto;
            box-shadow: 2px 0 4px rgba(0,0,0,0.1);
        }
        
        #map {
            flex: 1;
            height: 100%;
        }
        
        #info-panel {
            width: 350px;
            background-color: white;
            padding: 1rem;
            overflow-y: auto;
            box-shadow: -2px 0 4px rgba(0,0,0,0.1);
            display: none;
        }
        
        #info-panel.active {
            display: block;
        }
        
        .layer-control {
            margin-bottom: 1.5rem;
        }
        
        .layer-control h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: #333;
        }
        
        .layer-checkbox {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .layer-checkbox input {
            margin-right: 0.5rem;
        }
        
        .city-info {
            background-color: #f9f9f9;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .city-info h2 {
            color: #C71585;
            margin-bottom: 0.5rem;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid #eee;
        }
        
        .info-label {
            font-weight: bold;
            color: #666;
        }
        
        .info-value {
            color: #333;
        }
        
        .chart-container {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #f5f5f5;
            border-radius: 8px;
        }
        
        #footer {
            background-color: #333;
            color: white;
            padding: 1rem;
            text-align: center;
            font-size: 0.875rem;
        }
        
        .leaflet-popup-content {
            font-size: 0.875rem;
        }
        
        .legend {
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .legend h4 {
            margin-bottom: 5px;
            font-size: 0.875rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 5px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <div id="header">
        <h1>ğŸŒ¸ æ¡œçœŒã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒãƒƒãƒ—</h1>
        <p>å„å¸‚ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è©³ç´°æƒ…å ±ã‚’è¡¨ç¤º</p>
    </div>
    
    <div id="container">
        <div id="sidebar">
            <div class="layer-control">
                <h3>è¡¨ç¤ºãƒ¬ã‚¤ãƒ¤ãƒ¼</h3>
                <div class="layer-checkbox">
                    <input type="checkbox" id="cities-layer" checked>
                    <label for="cities-layer">å¸‚å¢ƒç•Œ</label>
                </div>
                <div class="layer-checkbox">
                    <input type="checkbox" id="labels-layer" checked>
                    <label for="labels-layer">åœ°åãƒ©ãƒ™ãƒ«</label>
                </div>
                <div class="layer-checkbox">
                    <input type="checkbox" id="population-layer">
                    <label for="population-layer">äººå£å¯†åº¦</label>
                </div>
            </div>
            
            <div class="layer-control">
                <h3>ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º</h3>
                <select id="data-type" style="width: 100%; padding: 0.5rem;">
                    <option value="none">ãªã—</option>
                    <option value="population">äººå£</option>
                    <option value="density">äººå£å¯†åº¦</option>
                    <option value="area">é¢ç©</option>
                </select>
            </div>
            
            <div class="layer-control">
                <h3>çµ±è¨ˆæƒ…å ±</h3>
                <div class="info-item">
                    <span class="info-label">ç·äººå£</span>
                    <span class="info-value">285ä¸‡4,327äºº</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ç·é¢ç©</span>
                    <span class="info-value">2,456.78 kmÂ²</span>
                </div>
                <div class="info-item">
                    <span class="info-label">å¸‚ã®æ•°</span>
                    <span class="info-value">6å¸‚</span>
                </div>
            </div>
        </div>
        
        <div id="map"></div>
        
        <div id="info-panel">
            <h2>è©³ç´°æƒ…å ±</h2>
            <div id="city-details">
                <p>å¸‚ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è©³ç´°ã‚’è¡¨ç¤º</p>
            </div>
        </div>
    </div>
    
    <div id="footer">
        <p>Â© 2025 æ¡œçœŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ | ãƒ‡ãƒ¼ã‚¿æœ€çµ‚æ›´æ–°: 2025å¹´7æœˆ11æ—¥</p>
    </div>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // åœ°å›³ã®åˆæœŸåŒ–
        const map = L.map('map').setView([35.45, 139.55], 10);
        
        // ãƒ™ãƒ¼ã‚¹ãƒãƒƒãƒ—
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);
        
        // å¸‚ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã®JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç°¡ç•¥åŒ–ï¼‰
        const cityData = {
            "æ¡œèŠ±å¸‚": {
                population: 890234,
                density: 1948.3,
                area: 456.78,
                type: "çœŒåºæ‰€åœ¨åœ°",
                industries: ["é‡‘èãƒ»ä¿é™ºæ¥­", "æƒ…å ±é€šä¿¡æ¥­", "å•†æ¥­ãƒ»ã‚µãƒ¼ãƒ“ã‚¹æ¥­"],
                mayor: "ç”°ä¸­ä¸€éƒ"
            },
            "æ¡œå·å¸‚": {
                population: 523456,
                density: 1344.2,
                area: 389.45,
                type: "æ¸¯æ¹¾éƒ½å¸‚",
                industries: ["æ¸¯æ¹¾ç‰©æµæ¥­", "æ°´ç”£æ¥­", "é€ èˆ¹æ¥­"],
                mayor: "æµ·é‡æ´‹å­"
            },
            "æ±æ¡œå¸‚": {
                population: 412345,
                density: 1319.2,
                area: 312.67,
                type: "ãƒã‚¤ãƒ†ã‚¯å·¥æ¥­éƒ½å¸‚",
                industries: ["é›»å­æ©Ÿå™¨è£½é€ æ¥­", "æƒ…å ±é€šä¿¡æ¥­", "ç ”ç©¶é–‹ç™º"],
                mayor: "æŠ€è¡“å¤ªéƒ"
            },
            "è¥¿æ¡œå¸‚": {
                population: 198765,
                density: 847.8,
                area: 234.56,
                type: "æ­´å²æ–‡åŒ–éƒ½å¸‚",
                industries: ["ä¼çµ±å·¥èŠ¸", "è¦³å…‰æ¥­", "æ–‡åŒ–ç”£æ¥­"],
                mayor: "æ–‡åŒ–èŠ±å­"
            },
            "å—æ¡œå¸‚": {
                population: 287654,
                density: 506.5,
                area: 567.89,
                type: "æ¸©æ³‰è¦³å…‰éƒ½å¸‚",
                industries: ["è¦³å…‰æ¥­", "æ—…é¤¨ãƒ»ãƒ›ãƒ†ãƒ«æ¥­", "è¾²æ¥­"],
                mayor: "æ¸©æ³‰æ¬¡éƒ"
            },
            "åŒ—æ¡œå¸‚": {
                population: 156789,
                density: 351.9,
                area: 445.67,
                type: "è¾²æ¥­éƒ½å¸‚",
                industries: ["è¾²æ¥­", "é£Ÿå“åŠ å·¥æ¥­", "ç•œç”£æ¥­"],
                mayor: "è¾²æ¥­ä¸‰éƒ"
            }
        };
        
        // è‰²ã®å–å¾—é–¢æ•°
        function getColor(density) {
            return density > 1500 ? '#800026' :
                   density > 1000 ? '#BD0026' :
                   density > 800  ? '#E31A1C' :
                   density > 600  ? '#FC4E2A' :
                   density > 400  ? '#FD8D3C' :
                   density > 200  ? '#FEB24C' :
                                    '#FFEDA0';
        }
        
        // ã‚¹ã‚¿ã‚¤ãƒ«é–¢æ•°
        function style(feature) {
            const city = cityData[feature.properties.name];
            return {
                fillColor: getColor(city ? city.density : 0),
                weight: 2,
                opacity: 1,
                color: 'white',
                dashArray: '3',
                fillOpacity: 0.7
            };
        }
        
        // ãƒã‚¤ãƒ©ã‚¤ãƒˆæ©Ÿèƒ½
        function highlightFeature(e) {
            const layer = e.target;
            
            layer.setStyle({
                weight: 5,
                color: '#666',
                dashArray: '',
                fillOpacity: 0.7
            });
            
            layer.bringToFront();
        }
        
        // ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½
        function resetHighlight(e) {
            geojsonLayer.resetStyle(e.target);
        }
        
        // ã‚¯ãƒªãƒƒã‚¯æ™‚ã®è©³ç´°è¡¨ç¤º
        function showCityDetails(cityName) {
            const city = cityData[cityName];
            if (!city) return;
            
            const infoPanel = document.getElementById('info-panel');
            infoPanel.classList.add('active');
            
            const detailsHtml = `
                <div class="city-info">
                    <h2>${cityName}</h2>
                    <div class="info-item">
                        <span class="info-label">ã‚¿ã‚¤ãƒ—</span>
                        <span class="info-value">${city.type}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">äººå£</span>
                        <span class="info-value">${city.population.toLocaleString()}äºº</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">é¢ç©</span>
                        <span class="info-value">${city.area} kmÂ²</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">äººå£å¯†åº¦</span>
                        <span class="info-value">${city.density}äºº/kmÂ²</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">å¸‚é•·</span>
                        <span class="info-value">${city.mayor}</span>
                    </div>
                </div>
                <div class="chart-container">
                    <h3>ä¸»è¦ç”£æ¥­</h3>
                    <ul>
                        ${city.industries.map(ind => `<li>${ind}</li>`).join('')}
                    </ul>
                </div>
            `;
            
            document.getElementById('city-details').innerHTML = detailsHtml;
        }
        
        // å„ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã«å¯¾ã™ã‚‹å‡¦ç†
        function onEachFeature(feature, layer) {
            // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—
            if (feature.properties && feature.properties.name) {
                const city = cityData[feature.properties.name];
                if (city) {
                    layer.bindPopup(`
                        <strong>${feature.properties.name}</strong><br>
                        äººå£: ${city.population.toLocaleString()}äºº<br>
                        é¢ç©: ${city.area} kmÂ²
                    `);
                }
            }
            
            // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
            layer.on({
                mouseover: highlightFeature,
                mouseout: resetHighlight,
                click: function(e) {
                    showCityDetails(feature.properties.name);
                }
            });
        }
        
        // ã‚µãƒ³ãƒ—ãƒ«GeoJSONãƒ‡ãƒ¼ã‚¿ï¼ˆç°¡ç•¥åŒ–ï¼‰
        const sakuraGeoJSON = {
            "type": "FeatureCollection",
            "features": [
                {
                    "type": "Feature",
                    "properties": {
                        "name": "æ¡œèŠ±å¸‚"
                    },
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [[
                            [139.45, 35.48],
                            [139.58, 35.48],
                            [139.58, 35.38],
                            [139.45, 35.38],
                            [139.45, 35.48]
                        ]]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {
                        "name": "æ¡œå·å¸‚"
                    },
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [[
                            [139.62, 35.38],
                            [139.75, 35.38],
                            [139.75, 35.28],
                            [139.62, 35.28],
                            [139.62, 35.38]
                        ]]
                    }
                }
                // ä»–ã®å¸‚ã‚‚åŒæ§˜ã«è¿½åŠ å¯èƒ½
            ]
        };
        
        // GeoJSONãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è¿½åŠ 
        const geojsonLayer = L.geoJSON(sakuraGeoJSON, {
            style: style,
            onEachFeature: onEachFeature
        }).addTo(map);
        
        // å‡¡ä¾‹ã®è¿½åŠ 
        const legend = L.control({position: 'bottomright'});
        
        legend.onAdd = function (map) {
            const div = L.DomUtil.create('div', 'legend');
            const grades = [0, 200, 400, 600, 800, 1000, 1500];
            
            div.innerHTML = '<h4>äººå£å¯†åº¦ï¼ˆäºº/kmÂ²ï¼‰</h4>';
            
            for (let i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<div class="legend-item">' +
                    '<div class="legend-color" style="background:' + getColor(grades[i] + 1) + '"></div>' +
                    grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] : '+') +
                    '</div>';
            }
            
            return div;
        };
        
        legend.addTo(map);
        
        // ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
        document.getElementById('population-layer').addEventListener('change', function(e) {
            if (e.target.checked) {
                legend.addTo(map);
            } else {
                legend.remove();
            }
        });
    </script>
</body>
</html>