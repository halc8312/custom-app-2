# 桜県住民データ生成システム ドキュメント

## 概要

このシステムは、桜県の全住民（約285万人）の詳細なデータを自動生成するためのNode.jsベースのツールです。日本の現実的な人口統計に基づき、整合性のある住民データを生成します。

## システム構成

### ファイル構造
```
sakura-ken/residents/
├── scripts/
│   ├── dataGenerator.js              # コアとなるデータ生成クラス
│   ├── generateBatch.js              # バッチ処理実装
│   ├── generateAllDistricts.js       # 全地区生成スクリプト
│   └── EXECUTE_TO_GENERATE_ALL_DATA.js # メイン実行スクリプト
├── data/
│   └── districts/                    # 生成されたデータの保存先
│       ├── skk-central-001.json
│       ├── skk-central-002.json
│       └── ... (約286ファイル)
└── README_DATA_GENERATION.md         # このドキュメント
```

## 生成データの仕様

### 1. 人口分布

#### 総人口: 2,854,327人

#### 市別人口
- **桜花市**: 892,456人（12地区）- 県都、商業・行政の中心
- **桜川市**: 524,189人（4地区）- 工業都市
- **東桜市**: 412,567人（4地区）- ベッドタウン
- **西桜市**: 198,347人（4地区）- 農業地域
- **南桜市**: 285,632人（4地区）- 観光都市
- **北桜市**: 541,136人（4地区）- 学園都市・複合都市

### 2. データフォーマット

#### ファイル構造
```json
{
  "metadata": {
    "version": "1.0",
    "generatedAt": "2024-01-13T12:00:00.000Z",
    "district": {
      "city": "桜花市",
      "name": "中央地区",
      "code": "central",
      "type": "central"
    },
    "statistics": {
      "totalResidents": 10000,
      "households": 3500,
      "averageAge": 42,
      "employmentRate": 0.72
    }
  },
  "households": [
    {
      "householdId": "central-H00001",
      "type": "nuclear",
      "members": [...],
      "address": "桜県桜花市中央地区1丁目2番3号",
      "phoneNumber": "0547-123-4567",
      "createdAt": "2024-01-13T12:00:00.000Z"
    }
  ]
}
```

#### 住民データ構造
```json
{
  "residentId": "SKK-central-2024-000001",
  "name": {
    "lastName": "佐藤",
    "firstName": "太郎",
    "lastNameKana": "サトウ",
    "firstNameKana": "タロウ"
  },
  "age": 42,
  "gender": "male",
  "relationship": "head",
  "occupation": "会社員",
  "education": "大学卒業",
  "employer": "桜電機株式会社",
  "income": 520,
  "address": "桜県桜花市中央地区1丁目2番3号",
  "registeredDate": "1982-04-01T00:00:00.000Z",
  "updatedAt": "2024-01-13T12:00:00.000Z"
}
```

### 3. 世帯タイプ

- **単身世帯** (35%): 1人暮らし
- **夫婦のみ** (20%): 夫婦2人
- **核家族** (25%): 夫婦と子供（3-5人）
- **三世代** (10%): 親・子・孫（5-7人）
- **ひとり親** (5%): 親と子供（2-4人）
- **その他** (5%): 上記以外の構成

### 4. 年齢分布（日本の人口ピラミッドに基づく）

- 0-17歳: 12%
- 18-29歳: 13%
- 30-39歳: 15%
- 40-49歳: 18%
- 50-59歳: 16%
- 60-69歳: 14%
- 70-79歳: 8%
- 80歳以上: 4%

### 5. 職業分布（地域特性を反映）

#### 中心市街地（central）
- 専門職: 25%
- 事務職: 35%
- サービス業: 20%
- 技術職: 15%
- その他: 5%

#### 工業地域（industrial）
- 製造業: 40%
- 技術職: 25%
- 事務職: 20%
- 運輸業: 10%
- その他: 5%

#### 住宅地域（residential）
- 事務職: 30%
- サービス業: 25%
- 小売業: 20%
- 専門職: 15%
- その他: 10%

#### 観光地域（tourism）
- サービス業: 35%
- 小売業: 25%
- 運輸業: 15%
- 事務職: 15%
- その他: 10%

#### 農村地域（rural）
- 農業: 35%
- 製造業: 20%
- 小売業: 15%
- サービス業: 15%
- その他: 15%

## 実行方法

### 1. 全データ生成（推奨）
```bash
cd sakura-ken/residents/scripts
node EXECUTE_TO_GENERATE_ALL_DATA.js
```

### 2. 特定の市のみ生成
```bash
node generateBatch.js --city SKK  # 桜花市のみ
node generateBatch.js --city SKG  # 桜川市のみ
```

### 3. プログラムから使用
```javascript
const BatchDataGenerator = require('./generateBatch');
const generator = new BatchDataGenerator();

// 全地区生成
await generator.generateAllDistricts();

// 特定市のみ
await generator.generateCity('SKK');
```

## パフォーマンスと要件

### システム要件
- Node.js: v14以上
- メモリ: 最低1GB（推奨2GB以上）
- ディスク空き容量: 3GB以上

### 処理時間の目安
- 全データ生成: 5-10分
- 1ファイル（10,000人）: 約2秒
- 1市の生成: 1-3分

### メモリ使用量
- 平均: 300-500MB
- ピーク時: 最大800MB

## データの特徴と品質

### 1. 現実性
- 日本の実際の人口統計に基づく年齢分布
- 一般的な日本人の姓名（上位200姓を使用）
- 地域特性を反映した職業・収入分布

### 2. 整合性
- 家族構成の年齢的整合性（親子の年齢差など）
- 職業と教育レベルの整合性
- 年齢と収入の相関

### 3. 多様性
- 200種類の姓、70種類の名前の組み合わせ
- 50種類以上の職業
- 6つの世帯タイプ

### 4. 地域性
- 市・地区ごとの特性を反映
- 地域による収入格差
- 職業分布の地域差

## トラブルシューティング

### メモリ不足エラー
```bash
# Node.jsのメモリ上限を増やす
node --max-old-space-size=4096 EXECUTE_TO_GENERATE_ALL_DATA.js
```

### ディスク容量不足
- 不要なファイルを削除してから実行
- 外部ストレージを使用

### 処理の中断と再開
- 生成は地区単位で行われるため、中断しても部分的なデータは残ります
- 既存ファイルは上書きされるため、再実行で継続可能

## カスタマイズ

### 人口数の変更
`generateBatch.js`の`getDistrictDefinitions()`メソッドで各地区の人口を調整できます。

### 職業の追加
`dataGenerator.js`の`occupations`オブジェクトに新しい職業カテゴリを追加できます。

### 企業名の変更
`dataGenerator.js`の`companies`オブジェクトで地域の企業名をカスタマイズできます。

## ライセンスと利用規約

このデータ生成システムは桜県プロジェクトの一部として開発されました。生成されたデータは架空のものであり、実在の人物・団体とは一切関係ありません。

---

最終更新日: 2024年1月13日